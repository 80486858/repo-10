# This file is generated by hacks/generate-controller-registration.sh - Do not commit, but change generation script!
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerDeployment
metadata:
  name: cri-resmgr-extension
type: helm
providerConfig:
  chart: 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

  values:
    ### For development purposes - set it to 0 (if you want to register extension but use local process with "make start").
    # replicaCount: 1            

    ### Uncomment this is you want to overwrite extension image or internal installation and agent images.
    ### Remember to build and push image  "make REGISTRY=v2.isvimgreg.com TAG=mybranch build-images push-images"
    ### "image" overwrites extension (for seed) and "images" overwrite installation/agent (for shoot) images defined in charts/images.yaml
    #image:
    #  repository: v2.isvimgreg.com/gardener-extension-cri-resmgr
    #  tag: mybranch
    #  pullPolicy: Always
    #imageVectorOverwrite: |
    #  images:
    #  - name: gardener-extension-cri-resmgr-installation
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-installation
    #  - name: gardener-extension-cri-resmgr-agent
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-agent
    ### Uncomment to provide own "fallback" configuration for CRI-Resource-Manager
    ### Use ballons policy as an example:
    # based on: https://github.com/intel/cri-resource-manager/blob/master/sample-configs/balloons-policy.cfg
    configs:
      ### Those options are passed directly to cri-resmgr binary.
      EXTRA_OPTIONS: | 
        EXTRA_OPTIONS="--metrics-interval 30s" 
      ### This is *static* initial configuraiton file that will be passed do systemd unit
      fallback: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-128
          ReservedResources:
            CPU: 1
          balloons:
            PinCPU: true
            PinMemory: true
            BalloonTypes:
              - Name: "smallBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        logger:
          Debug: resource-manager,cache,policy,config-server,cpuallocator
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
        dump:
          Debug: true
          #Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*
      ### This is *dynamic* config that will be applied by cri-resmgr-agent
      default: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-128
          ReservedResources:
            CPU: 1
          balloons:
            BalloonTypes:
              - Name: "smallHPBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
              - Name: "mediumLPBalloon"
                MinCPUs: 4
                MaxCPUs: 4
                MinBalloons: 1
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        logger:
          Debug: resource-manager,cache,policy,config-server,cpuallocator
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
        dump:
          Debug: true
          #Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*

---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerRegistration
metadata:
  name: cri-resmgr-extension
spec:
  deployment:
    # For development purpose - deploy the extensions before even shoots are created (or enabled)
    #policy: Always
    deploymentRefs:
    - name: cri-resmgr-extension
  resources:
  - kind: Extension
    type: cri-resmgr-extension
    globallyEnabled: false
    reconcileTimeout: "120s"
