# This file is generated by hacks/generate-controller-registration.sh - Do not commit, but change generation script!
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerDeployment
metadata:
  name: cri-resmgr-extension
type: helm
providerConfig:
  chart: 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

  values:
    ### For development purposes - set it to 0 (if you want to register extension but use local process with "make start").
    # replicaCount: 1            

    ### Uncomment this is you want to overwrite extension image or internal installation and agent images.
    ### Remember to build and push image  "make REGISTRY=v2.isvimgreg.com TAG=mybranch build-images push-images"
    ### "image" overwrites extension (for seed) and "images" overwrite installation/agent (for shoot) images defined in charts/images.yaml
    #image:
    #  repository: v2.isvimgreg.com/gardener-extension-cri-resmgr
    #  tag: mybranch
    #  pullPolicy: Always
    #imageVectorOverwrite: |
    #  images:
    #  - name: gardener-extension-cri-resmgr-installation
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-installation
    #  - name: gardener-extension-cri-resmgr-agent
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-agent
    ### Uncomment to provide own "fallback" configuration for CRI-Resource-Manager
    ### Use ballons policy as an example:
    # based on: https://github.com/intel/cri-resource-manager/blob/master/sample-configs/balloons-policy.cfg
    configs:
      ### Those options are passed directly to cri-resmgr binary.
      EXTRA_OPTIONS: | 
        EXTRA_OPTIONS="--metrics-interval 10s" 
      ### This is *dynamic* config that will be applied by cri-resmgr-agent
      default: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-128
          ReservedResources:
            CPU: 1
          balloons:
            BalloonTypes:
              - Name: "HP-balloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
                Namespaces:
                - nginx
              - Name: "LP-balloon"
                MinCPUs: 4
                MaxCPUs: 4
                MinBalloons: 1
                Namespaces:
                - stress
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        logger:
          Debug: resource-manager,cache,policy,config-server,cpuallocator
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
        dump:
          Debug: true
          #Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*
      ### This is *static* initial configuraiton file that will be passed do systemd unit
      fallback: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-128
          ReservedResources:
            CPU: 1
          balloons:
            PinCPU: true
            PinMemory: true
            BalloonTypes:
              - Name: "defaultBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
                Namespaces:
                - default
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        logger:
          Debug: resource-manager,cache,policy,config-server,cpuallocator
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
        dump:
          Debug: true
          #Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*

---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerRegistration
metadata:
  name: cri-resmgr-extension
spec:
  deployment:
    # For development purpose - deploy the extensions before even shoots are created (or enabled)
    #policy: Always
    deploymentRefs:
    - name: cri-resmgr-extension
  resources:
  - kind: Extension
    type: cri-resmgr-extension
    globallyEnabled: false
    reconcileTimeout: "120s"
